大家好，我是小菜，一个渴望在互联网行业做到蔡不菜的小菜。可柔可刚，点赞则柔，白嫖则刚！
**死鬼~看完记得给我来个三连哦！**


![](https://user-gold-cdn.xitu.io/2020/4/11/17169c46045528af?w=240&h=224&f=jpeg&s=7529)


>本文主要介绍 `分布式事务`
>
>如有需要，可以参考
>
>如有帮助，不忘 **点赞** ❥
>
>
>微信公众号已开启，**小菜良记**，没关注的同学们记得关注哦！

`生活可能对你耍无赖，但科技不行`

我去小卖部买东西，付完了钱，老板转身抽了口烟，却忘记了我付完钱？这种情况怎么办，发生在日常生活并不奇怪。但是你在网上下单，付完了钱，刚要查看订单，却提示你待支付，心中几万只草泥马跑过也不得而知！所以防止这种情况的发生，分布式事务也变得尤为重要。

有人纳闷了，付不付钱跟分布式事务有什么关系，这不是程序耍无赖吗？但是耍无赖的背后却是因为分布式事务在作祟！如果还不明白，那可能你还没明白什么是事务，什么是分布式事务~

### 分布式事务

#### 定义

事务提供一种机制将一个活动涉及的所有操作都纳入到一个不可分割的执行单元，组成事务的祝所有操作只有在操作均正常执行的情况下才能提交，只要其中任一操作执行失败，都会导致整个事务的回滚。简单来说，`要么做，要么不做`。

听起来有点 `man`，不要迷恋，先来了解一下事务的四大特性：`ACID`

- **A（Atomic）**：原子性，构成事物的所有操作，要么全部执行完成，要么全部不执行，不可能出现部分成功部分失败的情况。
- **C（Consistency）**：一致性，在事务执行前后，数据库的一致性约束没有被破坏。一旦所有事务动作完成，事务就被提交，数据和资源处于一种满足业务规则的一致性状态中。比如上面说的，我向商店老板付了钱，我这边扣除了100，而老板增加了100，这种就称为一致性。
- **I（Isolation）**：隔离性，数据库中的事务一般都是并发的，隔离性是指并发的两个事务互不干扰，一个事务不能看到其他事务运行过程的中间状态，通过配置事务隔离级别可以避免在脏读、幻读、不可重复读等问题。
- **D（Durability）**：持久性，事务完成之后，该事务对数据的更改会持久化到数据库中，并且不会被回滚

##### 单体事务

早期我们使用的还是单体架构，像是一个大家族，其乐融融的生活在一起日夜耕作。

![](https://gitee.com/cbuc/picture/raw/master/20210319124841.png)

时间久了，各种各样的问题自然而然的也出现了：`复杂性高，部署频率低，可靠性差，扩展能力受限...` 承受了太多不该承受的流言蜚语，而大家也逐渐找寻新的出路， 那微服务架构也便受应出现：



##### 分布式事务

![](https://gitee.com/cbuc/picture/raw/master/20210319130155.png)