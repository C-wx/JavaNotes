大家好，欢迎来到小菜个人 **solo** 学堂。在这里，知识免费，不吝吸收！关注免费，不吝动手！
**死鬼~看完记得给我来个三连哦！**


![](https://gitee.com/cbuc/picture/raw/master/typora/20210411110759.jpeg)


>本文主要介绍 `kubernetes 的使用`
>
>如有需要，可以参考
>
>如有帮助，不忘 **点赞** ❥
>
>
>微信公众号已开启，**小菜良记**，没关注的同学们记得关注哦！

上篇文章我们说到如何搭建 **k8s** 集群，不知道看完的小伙伴有没有自己去尝试一下呢！

[不要让贫穷扼杀了你学 k8s 的兴趣]()

这篇我们本着善始善终的原则，一文教会你如何使用 k8s ，成为别人家的程序员~

我们老样子，先回顾下 k8s 中存在的几种组件：

![](https://gitee.com/cbuc/picture/raw/master/typora/20210411111150.png)

那我们还得了解一下 k8s 中几种常见的资源：

- **Master：** 集群控制节点，每个集群都至少需要一个 **master** 节点负责集群的管控
- **Node：** 工作负载节点，由 **master** 分配容器到这些 **node** 节点上，然后 **node** 节点上的docker 负责容器的运行
- **Pod：** kubernetes的最小控制单元，容器都是运行在 pod 中的，一个pod中可以有 1 个或多个容器
- **Controller：** 控制器，通过它来实现对 pod 的管理，比如启动 pod，停止 pod，伸缩 pod 的数量等等
- **Service：** pod 对外服务的统一入口，可以维护同一类的多个 pod
- **Label：** 标签，用于对 pod 进行分类，同一类的 pod 会拥有相同的标签
- **NameSpace：** 命名空间，用来隔离 pod 的运行环境

这几个概念先初步有个了解即可，接下来便是对每个概念展开说明的时候~那么，正片开始！

### Kubernetes

#### 一、Kuberctl

这个是 **kubernetes** 集群的命令行工具，通过 **kubectl** 能够对集群本身进行管理，并能够在集群上进行容器化应用的安装部署。可以想象我们接下来的操作绝大部分都需要借助这个命令工具的帮助。

我们之前也已经使用过一次了：`kubectl get nodes` 。这个命令便是用来获取集群中各个节点状态的，那么不难以想象，这个命令的语法：

```shell
kubectl [command] [TYPE] [NAME] [flags]
```

- **command：**指定对资源执行的操作、例如：`create、get、describe、delete...`

- **TYPE：** 指定资源类型。资源类型是大小写敏感的，开发者能以单数、复数和缩写的形式，例如：`pod、pods、po`

- **NAME：** 指定资源的名称。名称也是大小写敏感的，如果省略名称，则会显示所有的资源，例如 ：`kubectl get pods`

- **flags：** 指定可选的参数。例如：`-s 、-server`

**k8s** 支持的 **command** 有很多，我们可以跟 docker 一样使用 `kubectl --help` 来获取帮助文档：

![](https://gitee.com/cbuc/picture/raw/master/typora/20210411160248.png)

文档很多，当然有些是常用的，有些是不常用的，小菜在这里给你们简单分个类，下次有需要可以直接查看分类中的结果~

##### 1）命令分类

###### 1、 基础命令

|  名称   |                 描述                 |
| :-----: | :----------------------------------: |
| create  |     通过文件名或标准输入创建资源     |
| expose  |   将一个资源公开为一个新的 Service   |
|   run   |      在集群中运行一个特定的镜像      |
|   set   |        在对象上设置特定的功能        |
|   get   |          显示一个或多个资源          |
|  edit   |     使用默认的编辑器编辑一个资源     |
| delete  | 通过文件名、标准输入、资源名称或标签 |
| explain |           获取文档参考资料           |

###### 2、部署命令

|      名称      |                             描述                             |
| :------------: | :----------------------------------------------------------: |
|    rollout     |                        管理资源的发布                        |
| rolling-update |                  对给定的控制器进行滚动更新                  |
|     scale      | 扩容或缩容 pod 数量，可对 `Deployment、ReplicaSet、RC或Job` 操作 |
|   autoscale    |          创建一个自动选择扩容或缩容并设置 pod 数量           |

###### 3、 集群管理命令

|     名称     |                描述                 |
| :----------: | :---------------------------------: |
| certificate  |            修改证书资源             |
| cluster-info |            显示集群信息             |
|     top      | 显示资源使用情况，需要运行 Heapster |
|    cordon    |          标记节点不可调度           |
|   uncordon   |           标记节点可调度            |
|    drain     |   驱逐节点上的应用，准备下线维护    |
|    taint     |        修改节点的 taint 标记        |

###### 4、故障\调试命令

|     名称     |                             描述                             |
| :----------: | :----------------------------------------------------------: |
|   describe   |                显示特定资源或资源组的详细信息                |
|     logs     | 在一个 pod 中打印容器日志，如果 pod 中只有多个容器，容器名称是可选的 |
|    attach    |                     附加到一个运行的容器                     |
|     exec     |                     执行一个命令到容器中                     |
| port-forward |               转发一个或多个本地端口到一个 pod               |
|    proxy     |            运行一个 proxy 到 kubernetes ApiServer            |
|      cp      |                    拷贝文件或目录到容器中                    |
|     auth     |                           检查授权                           |

###### 6、高级命令

|  名称   |                描述                |
| :-----: | :--------------------------------: |
|  apply  | 通过文件名或标准输入对资源应用配置 |
|  patch  |    使用补丁修改、更新资源的字段    |
| replace |  通过文件名或标准输入替换一个资源  |
| convert |   不同的API 版本之间转换配置文件   |

###### 7、设置命令

|    名称    |             描述              |
| :--------: | :---------------------------: |
|   label    |       更新资源上的标签        |
|  annotate  |       更新资源上的标签        |
| completion | 用于实现 kubectl 工具自动补全 |

###### 8、其他命令

|     名称     |                          描述                          |
| :----------: | :----------------------------------------------------: |
| api-versions |                 打印受支持的 API 版本                  |
|    config    | 修改 kubeconfig 文件（用于访问 API，比如配置认证信息） |
|     help     |                    获取所有命令帮助                    |
|    plugin    |                   运行一个命令行插件                   |
|   version    |                打印客户端和服务版本信息                |

这么多命令铺天盖地的袭来，是不是对 k8s 的学习产生了些许动摇。不过不必担心，小菜列出这些命令只是为了让你提前熟悉，混个眼熟，并非开场劝退，真正的学习即将来临~

#### 二、资源管理

在 kubernetes 中，所有的内容都抽象为资源，用户需要通过操作资源来管理 **kubernetes**

